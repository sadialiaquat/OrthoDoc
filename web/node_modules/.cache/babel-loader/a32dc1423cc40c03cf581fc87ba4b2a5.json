{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Ahmed\\\\Desktop\\\\OrthoDoc\\\\web\\\\src\\\\Pages\\\\Messenger.js\",\n    _s = $RefreshSig$();\n\n// import { authentication } from '../firebase-config';\n// import { useNavigate } from 'react-router-dom';\n// import { useState, useEffect } from \"react\";\n// import { db } from '../firebase-config';\n// import { collection, getDocs } from \"firebase/firestore\";\n// import { query, where } from \"firebase/firestore\";\n// import { getAuth, onAuthStateChanged } from \"firebase/auth\";\n// function Messenger() {\n//  /* const [currentChat, setCurrentChat] = useState();\n// return (\n//    <>\n//      <div className=\"messenger\">\n//        <div className=\"chatMenu\">\n//          <div className=\"chatMenuWrapper\">\n//            <input placeholder=\"Search for doctors\" className=\"chatMenuInput\" />\n//            <Conversation/>          \n//          </div>\n//        </div>\n//        <div className=\"chatBox\">\n//          <div className=\"chatBoxWrapper\">\n//          {currentChat ? (<>\n//        <div className='chatBoxTop'>\n//          <Message/>\n//     <Message own={true}/>  \n//        </div>\n//        <div className=\"chatBoxBottom\">\n//    <textarea className=\"chatMessageInput\" placeholder=\"Write something..\"></textarea>\n//    <button className=\"chatSubmitButton\">\n//                   <div className='sendicon'>  <MdSend/></div>\n//                  </button>\n// </div> </>):(\n//               <span className=\"noConversationText\">\n//                 Open a conversation to start a chat.\n//               </span>\n//             )}\n//          </div>\n//        </div>\n//      </div>\n//      <Link to='/home'>\n//      <div className='backtohome'><FaArrowCircleLeft/></div></Link>\n//    </>\n//  );\n// }*/\n// const [users, setusers] = useState([]);\n//  console.log(\"AUTH\"+ authentication.currentUser.email);\n//  if(!authentication.currentUser){\n//    alert(\"Please Login First\");\n//    //navigation.navigate(\"login\");\n// }\n// const mail = authentication.currentUser.email;\n//  const auth = getAuth();\n//  const querySnapshot = async () => {\n//    const col = collection(db, \"chatroom\");\n//    const q = query(\n//      col,\n//      where(\"sentBy\", \"==\", authentication.currentUser?.email)\n//    );\n//    const q2 = query(\n//      col,\n//      where(\"sentTo\", \"==\", authentication.currentUser?.email)\n//    );\n//    const snap = await getDocs(q);\n//    const snap3 = await getDocs(q2);\n//    let usersEmail = [];\n//    console.log(\"b4 snap 1\");\n//    snap.forEach((doc) => {\n//      if (!usersEmail.find((email) => email == doc.data().sentTo)) {\n//        usersEmail.push(doc.data().sentTo);\n//      }\n//    });\n//    console.log(users);\n//    snap3.forEach((doc) => {\n//      if (!usersEmail.find((email) => email == doc.data().sentBy)) {\n//        // if (doc.data().sentTo != props.route.params.params.param1)\n//        usersEmail.push(doc.data().sentBy);\n//      }\n//    });  //  console.log(users);\n//    usersEmail.map(async (email) => {\n//      const col2 = collection(db, \"doctors\");\n//      const q2 = query(col2, where(\"email\", \"==\", email));\n//      const snap2 = await getDocs(q2);\n//      snap2.forEach((doc) => {\n//        setusers((user) => [...user, doc.data()]);\n//      });\n//    });\n//  };\n//  useEffect(() => {\n//    querySnapshot();\n//  }, []);\n// return (\n//     <div className=\"conversation\">\n//       {users.map((user)=>{\n//  <a> <p style={{color:'white'}}>{user.displayName?? user.name} </p></a> \n//  } ) }\n//     </div>\n//   )}\n// export default Messenger;\nimport React from 'react';\nimport { authentication } from '../firebase-config';\nimport { useNavigate } from 'react-router-dom';\nimport { useState, useEffect } from \"react\";\nimport { db } from '../firebase-config';\nimport { collection, getDocs } from \"firebase/firestore\";\nimport { query, where } from \"firebase/firestore\";\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Messenger() {\n  _s();\n\n  const navigate = useNavigate(); // useEffect(()=>{\n  //    if(!authentication.currentUser){\n  //       navigate('/login');\n  //     return <div className='splash'>\n  //        Loading\n  //  </div>\n  //    }\n  // },[])\n\n  const [users, setusers] = useState([]);\n  console.log(\"AUTH\" + authentication.currentUser.email);\n\n  if (!authentication.currentUser) {\n    alert(\"Please Login First\"); //navigation.navigate(\"login\");\n  }\n\n  const mail = authentication.currentUser.email;\n  const auth = getAuth();\n  let usersEmail = [];\n\n  const querySnapshot = async () => {\n    var _authentication$curre, _authentication$curre2;\n\n    const col = collection(db, \"chatroom\");\n    const q = query(col, where(\"sentBy\", \"==\", (_authentication$curre = authentication.currentUser) === null || _authentication$curre === void 0 ? void 0 : _authentication$curre.email));\n    const q2 = query(col, where(\"sentTo\", \"==\", (_authentication$curre2 = authentication.currentUser) === null || _authentication$curre2 === void 0 ? void 0 : _authentication$curre2.email));\n    const snap = await getDocs(q);\n    const snap3 = await getDocs(q2); //let usersEmail = [];\n\n    console.log(\"b4 snap 1\");\n    snap.forEach(doc => {\n      if (!usersEmail.find(email => email == doc.data().sentTo)) {\n        usersEmail.push(doc.data().sentTo);\n      }\n    });\n    console.log(\"b4 snap 3\");\n    snap3.forEach(doc => {\n      if (!usersEmail.find(email => email == doc.data().sentBy)) {\n        // if (doc.data().sentTo != props.route.params.params.param1)\n        usersEmail.push(doc.data().sentBy);\n      }\n    });\n    console.log(users);\n    usersEmail.map(async email => {\n      const col2 = collection(db, \"doctors\");\n      const q2 = query(col2, where(\"email\", \"==\", email));\n      const snap2 = await getDocs(q2);\n      snap2.forEach(doc => {\n        console.log(\"hello\");\n        setusers(user => [...user, doc.data()]);\n      });\n    });\n  };\n\n  useEffect(() => {\n    querySnapshot();\n  }, []);\n  usersEmail.forEach(d => {\n    setusers(prev => [...prev, d.data()]);\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"conversation\",\n    children: users.map(user => {\n      var _user$displayName;\n\n      /*#__PURE__*/\n      _jsxDEV(\"a\", {\n        children: [\" \", /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: 'white'\n          },\n          children: [\"Users are:\", (_user$displayName = user.displayName) !== null && _user$displayName !== void 0 ? _user$displayName : user.name, \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 2\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 205,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Messenger, \"a8OhDfMGVKZltYB52D48N2hMqRk=\", false, function () {\n  return [useNavigate];\n});\n\n_c = Messenger;\nexport default Messenger;\n\nvar _c;\n\n$RefreshReg$(_c, \"Messenger\");","map":{"version":3,"sources":["C:/Users/Ahmed/Desktop/OrthoDoc/web/src/Pages/Messenger.js"],"names":["React","authentication","useNavigate","useState","useEffect","db","collection","getDocs","query","where","getAuth","onAuthStateChanged","Messenger","navigate","users","setusers","console","log","currentUser","email","alert","mail","auth","usersEmail","querySnapshot","col","q","q2","snap","snap3","forEach","doc","find","data","sentTo","push","sentBy","map","col2","snap2","user","d","prev","color","displayName","name"],"mappings":";;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,cAAT,QAA+B,oBAA/B;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SAASC,EAAT,QAAmB,oBAAnB;AACA,SAASC,UAAT,EAAqBC,OAArB,QAAoC,oBAApC;AACA,SAASC,KAAT,EAAgBC,KAAhB,QAA6B,oBAA7B;AACA,SAASC,OAAT,EAAkBC,kBAAlB,QAA4C,eAA5C;;;AACA,SAASC,SAAT,GAAoB;AAAA;;AAClB,QAAMC,QAAQ,GAAGX,WAAW,EAA5B,CADkB,CAEnB;AACC;AACC;AACE;AACC;AACE;AACN;AACD;;AACA,QAAM,CAACY,KAAD,EAAQC,QAAR,IAAoBZ,QAAQ,CAAC,EAAD,CAAlC;AACAa,EAAAA,OAAO,CAACC,GAAR,CAAY,SAAQhB,cAAc,CAACiB,WAAf,CAA2BC,KAA/C;;AACA,MAAG,CAAClB,cAAc,CAACiB,WAAnB,EAA+B;AAE7BE,IAAAA,KAAK,CAAC,oBAAD,CAAL,CAF6B,CAG7B;AACF;;AACD,QAAMC,IAAI,GAAGpB,cAAc,CAACiB,WAAf,CAA2BC,KAAxC;AACC,QAAMG,IAAI,GAAGZ,OAAO,EAApB;AACA,MAA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","sourcesContent":["\r\n\r\n\r\n// import { authentication } from '../firebase-config';\r\n// import { useNavigate } from 'react-router-dom';\r\n// import { useState, useEffect } from \"react\";\r\n// import { db } from '../firebase-config';\r\n// import { collection, getDocs } from \"firebase/firestore\";\r\n// import { query, where } from \"firebase/firestore\";\r\n// import { getAuth, onAuthStateChanged } from \"firebase/auth\";\r\n// function Messenger() {\r\n//  /* const [currentChat, setCurrentChat] = useState();\r\n// return (\r\n//    <>\r\n//      <div className=\"messenger\">\r\n//        <div className=\"chatMenu\">\r\n//          <div className=\"chatMenuWrapper\">\r\n//            <input placeholder=\"Search for doctors\" className=\"chatMenuInput\" />\r\n//            <Conversation/>          \r\n//          </div>\r\n//        </div>\r\n//        <div className=\"chatBox\">\r\n//          <div className=\"chatBoxWrapper\">\r\n//          {currentChat ? (<>\r\n//        <div className='chatBoxTop'>\r\n//          <Message/>\r\n//     <Message own={true}/>  \r\n\r\n//        </div>\r\n//        <div className=\"chatBoxBottom\">\r\n//    <textarea className=\"chatMessageInput\" placeholder=\"Write something..\"></textarea>\r\n//    <button className=\"chatSubmitButton\">\r\n//                   <div className='sendicon'>  <MdSend/></div>\r\n//                  </button>\r\n// </div> </>):(\r\n//               <span className=\"noConversationText\">\r\n//                 Open a conversation to start a chat.\r\n//               </span>\r\n//             )}\r\n//          </div>\r\n//        </div>\r\n       \r\n//      </div>\r\n//      <Link to='/home'>\r\n//      <div className='backtohome'><FaArrowCircleLeft/></div></Link>\r\n//    </>\r\n//  );\r\n// }*/\r\n\r\n\r\n\r\n// const [users, setusers] = useState([]);\r\n//  console.log(\"AUTH\"+ authentication.currentUser.email);\r\n//  if(!authentication.currentUser){\r\n   \r\n//    alert(\"Please Login First\");\r\n//    //navigation.navigate(\"login\");\r\n// }\r\n// const mail = authentication.currentUser.email;\r\n//  const auth = getAuth();\r\n\r\n//  const querySnapshot = async () => {\r\n\r\n//    const col = collection(db, \"chatroom\");\r\n//    const q = query(\r\n//      col,\r\n//      where(\"sentBy\", \"==\", authentication.currentUser?.email)\r\n//    );\r\n//    const q2 = query(\r\n//      col,\r\n//      where(\"sentTo\", \"==\", authentication.currentUser?.email)\r\n//    );\r\n\r\n//    const snap = await getDocs(q);\r\n//    const snap3 = await getDocs(q2);\r\n\r\n//    let usersEmail = [];\r\n//    console.log(\"b4 snap 1\");\r\n//    snap.forEach((doc) => {\r\n\r\n//      if (!usersEmail.find((email) => email == doc.data().sentTo)) {\r\n//        usersEmail.push(doc.data().sentTo);\r\n//      }\r\n//    });\r\n//    console.log(users);\r\n//    snap3.forEach((doc) => {\r\n\r\n//      if (!usersEmail.find((email) => email == doc.data().sentBy)) {\r\n//        // if (doc.data().sentTo != props.route.params.params.param1)\r\n//        usersEmail.push(doc.data().sentBy);\r\n//      }\r\n\r\n//    });  //  console.log(users);\r\n\r\n//    usersEmail.map(async (email) => {\r\n//      const col2 = collection(db, \"doctors\");\r\n//      const q2 = query(col2, where(\"email\", \"==\", email));\r\n//      const snap2 = await getDocs(q2);\r\n//      snap2.forEach((doc) => {\r\n//        setusers((user) => [...user, doc.data()]);\r\n//      });\r\n     \r\n//    });\r\n//  };\r\n\r\n\r\n//  useEffect(() => {\r\n//    querySnapshot();\r\n//  }, []);\r\n\r\n\r\n\r\n// return (\r\n//     <div className=\"conversation\">\r\n//       {users.map((user)=>{\r\n//  <a> <p style={{color:'white'}}>{user.displayName?? user.name} </p></a> \r\n//  } ) }\r\n//     </div>\r\n//   )}\r\n\r\n// export default Messenger;\r\n\r\nimport React from 'react';\r\nimport { authentication } from '../firebase-config';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useState, useEffect } from \"react\";\r\nimport { db } from '../firebase-config';\r\nimport { collection, getDocs } from \"firebase/firestore\";\r\nimport { query, where } from \"firebase/firestore\";\r\nimport { getAuth, onAuthStateChanged } from \"firebase/auth\";\r\nfunction Messenger(){\r\n  const navigate = useNavigate();\r\n // useEffect(()=>{\r\n  //    if(!authentication.currentUser){\r\n   //       navigate('/login');\r\n     //     return <div className='splash'>\r\n      //        Loading\r\n        //  </div>\r\n  //    }\r\n // },[])\r\n const [users, setusers] = useState([]);\r\n console.log(\"AUTH\"+ authentication.currentUser.email);\r\n if(!authentication.currentUser){\r\n   \r\n   alert(\"Please Login First\");\r\n   //navigation.navigate(\"login\");\r\n}\r\nconst mail = authentication.currentUser.email;\r\n const auth = getAuth();\r\n let usersEmail = [];\r\n const querySnapshot = async () => {\r\n\r\n   const col = collection(db, \"chatroom\");\r\n   const q = query(\r\n     col,\r\n     where(\"sentBy\", \"==\", authentication.currentUser?.email)\r\n   );\r\n   const q2 = query(\r\n     col,\r\n     where(\"sentTo\", \"==\", authentication.currentUser?.email)\r\n   );\r\n\r\n   const snap = await getDocs(q);\r\n   const snap3 = await getDocs(q2);\r\n\r\n   //let usersEmail = [];\r\n   console.log(\"b4 snap 1\");\r\n   snap.forEach((doc) => {\r\n\r\n     if (!usersEmail.find((email) => email == doc.data().sentTo)) {\r\n       usersEmail.push(doc.data().sentTo);\r\n     }\r\n   });\r\n   console.log(\"b4 snap 3\");\r\n   snap3.forEach((doc) => {\r\n\r\n     if (!usersEmail.find((email) => email == doc.data().sentBy)) {\r\n       // if (doc.data().sentTo != props.route.params.params.param1)\r\n       usersEmail.push(doc.data().sentBy);\r\n     }\r\n\r\n   });    console.log(users);\r\n\r\n   usersEmail.map(async (email) => {\r\n     const col2 = collection(db, \"doctors\");\r\n     const q2 = query(col2, where(\"email\", \"==\", email));\r\n     const snap2 = await getDocs(q2);\r\n     snap2.forEach((doc) => {\r\n  console.log(\"hello\");\r\n       setusers((user) => [...user, doc.data()]);\r\n     });\r\n     \r\n   });\r\n };\r\n\r\n\r\n useEffect(() => {\r\n   querySnapshot();\r\n }, []);\r\n\r\n  usersEmail.forEach((d)=>{\r\n   setusers((prev) => [...prev, d.data()]);\r\n  })\r\nreturn (\r\n    <div className=\"conversation\">\r\n      {users.map((user)=>{\r\n <a> <p style={{color:'white'}}>Users are:{user.displayName?? user.name} </p></a> \r\n } ) }\r\n    </div>\r\n  )}\r\nexport default Messenger;"]},"metadata":{},"sourceType":"module"}