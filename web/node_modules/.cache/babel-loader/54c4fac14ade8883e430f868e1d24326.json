{"ast":null,"code":"// Generated by CoffeeScript 1.3.3\n(function () {\n  var events,\n      isEmpty,\n      sax,\n      __hasProp = {}.hasOwnProperty,\n      __extends = function (child, parent) {\n    for (var key in parent) {\n      if (__hasProp.call(parent, key)) child[key] = parent[key];\n    }\n\n    function ctor() {\n      this.constructor = child;\n    }\n\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n    child.__super__ = parent.prototype;\n    return child;\n  },\n      __bind = function (fn, me) {\n    return function () {\n      return fn.apply(me, arguments);\n    };\n  };\n\n  sax = require('sax');\n  events = require('events');\n\n  isEmpty = function (thing) {\n    return typeof thing === \"object\" && thing != null && Object.keys(thing).length === 0;\n  };\n\n  exports.defaults = {\n    \"0.1\": {\n      explicitCharkey: false,\n      trim: true,\n      normalize: true,\n      attrkey: \"@\",\n      charkey: \"#\",\n      explicitArray: false,\n      ignoreAttrs: false,\n      mergeAttrs: false,\n      explicitRoot: false,\n      validator: null\n    },\n    \"0.2\": {\n      explicitCharkey: false,\n      trim: false,\n      normalize: false,\n      attrkey: \"$\",\n      charkey: \"_\",\n      explicitArray: true,\n      ignoreAttrs: false,\n      mergeAttrs: false,\n      explicitRoot: true,\n      validator: null\n    }\n  };\n\n  exports.ValidationError = function (_super) {\n    __extends(ValidationError, _super);\n\n    function ValidationError(message) {\n      this.message = message;\n    }\n\n    return ValidationError;\n  }(Error);\n\n  exports.Parser = function (_super) {\n    __extends(Parser, _super);\n\n    function Parser(opts) {\n      this.parseString = __bind(this.parseString, this);\n      this.reset = __bind(this.reset, this);\n\n      var key, value, _ref;\n\n      this.options = {};\n      _ref = exports.defaults[\"0.2\"];\n\n      for (key in _ref) {\n        if (!__hasProp.call(_ref, key)) continue;\n        value = _ref[key];\n        this.options[key] = value;\n      }\n\n      for (key in opts) {\n        if (!__hasProp.call(opts, key)) continue;\n        value = opts[key];\n        this.options[key] = value;\n      }\n\n      this.reset();\n    }\n\n    Parser.prototype.reset = function () {\n      var attrkey,\n          charkey,\n          err,\n          stack,\n          _this = this;\n\n      this.removeAllListeners();\n      this.saxParser = sax.parser(true, {\n        trim: false,\n        normalize: false\n      });\n      err = false;\n\n      this.saxParser.onerror = function (error) {\n        if (!err) {\n          err = true;\n          return _this.emit(\"error\", error);\n        }\n      };\n\n      this.EXPLICIT_CHARKEY = this.options.explicitCharkey;\n      this.resultObject = null;\n      stack = [];\n      attrkey = this.options.attrkey;\n      charkey = this.options.charkey;\n\n      this.saxParser.onopentag = function (node) {\n        var key, obj, _ref;\n\n        obj = {};\n        obj[charkey] = \"\";\n\n        if (!_this.options.ignoreAttrs) {\n          _ref = node.attributes;\n\n          for (key in _ref) {\n            if (!__hasProp.call(_ref, key)) continue;\n\n            if (!(attrkey in obj) && !_this.options.mergeAttrs) {\n              obj[attrkey] = {};\n            }\n\n            if (_this.options.mergeAttrs) {\n              obj[key] = node.attributes[key];\n            } else {\n              obj[attrkey][key] = node.attributes[key];\n            }\n          }\n        }\n\n        obj[\"#name\"] = node.name;\n        return stack.push(obj);\n      };\n\n      this.saxParser.onclosetag = function () {\n        var node, nodeName, obj, old, s, xpath;\n        obj = stack.pop();\n        nodeName = obj[\"#name\"];\n        delete obj[\"#name\"];\n        s = stack[stack.length - 1];\n\n        if (obj[charkey].match(/^\\s*$/)) {\n          delete obj[charkey];\n        } else {\n          if (_this.options.trim) {\n            obj[charkey] = obj[charkey].trim();\n          }\n\n          if (_this.options.normalize) {\n            obj[charkey] = obj[charkey].replace(/\\s{2,}/g, \" \").trim();\n          }\n\n          if (Object.keys(obj).length === 1 && charkey in obj && !_this.EXPLICIT_CHARKEY) {\n            obj = obj[charkey];\n          }\n        }\n\n        if (_this.options.emptyTag !== void 0 && isEmpty(obj)) {\n          obj = _this.options.emptyTag;\n        }\n\n        if (_this.options.validator != null) {\n          xpath = \"/\" + function () {\n            var _i, _len, _results;\n\n            _results = [];\n\n            for (_i = 0, _len = stack.length; _i < _len; _i++) {\n              node = stack[_i];\n\n              _results.push(node[\"#name\"]);\n            }\n\n            return _results;\n          }().concat(nodeName).join(\"/\");\n\n          obj = _this.options.validator(xpath, s && s[nodeName], obj);\n        }\n\n        if (stack.length > 0) {\n          if (!_this.options.explicitArray) {\n            if (!(nodeName in s)) {\n              return s[nodeName] = obj;\n            } else if (s[nodeName] instanceof Array) {\n              return s[nodeName].push(obj);\n            } else {\n              old = s[nodeName];\n              s[nodeName] = [old];\n              return s[nodeName].push(obj);\n            }\n          } else {\n            if (!(s[nodeName] instanceof Array)) {\n              s[nodeName] = [];\n            }\n\n            return s[nodeName].push(obj);\n          }\n        } else {\n          if (_this.options.explicitRoot) {\n            old = obj;\n            obj = {};\n            obj[nodeName] = old;\n          }\n\n          _this.resultObject = obj;\n          return _this.emit(\"end\", _this.resultObject);\n        }\n      };\n\n      return this.saxParser.ontext = this.saxParser.oncdata = function (text) {\n        var s;\n        s = stack[stack.length - 1];\n\n        if (s) {\n          return s[charkey] += text;\n        }\n      };\n    };\n\n    Parser.prototype.parseString = function (str, cb) {\n      if (cb != null && typeof cb === \"function\") {\n        this.on(\"end\", function (result) {\n          this.reset();\n          return cb(null, result);\n        });\n        this.on(\"error\", function (err) {\n          this.reset();\n          return cb(err);\n        });\n      }\n\n      if (str.toString().trim() === '') {\n        this.emit(\"end\", null);\n        return true;\n      }\n\n      try {\n        return this.saxParser.write(str.toString());\n      } catch (ex) {\n        if (ex instanceof exports.ValidationError) {\n          return this.emit(\"error\", ex.message);\n        } else {\n          throw ex;\n        }\n      }\n    };\n\n    return Parser;\n  }(events.EventEmitter);\n}).call(this);","map":{"version":3,"sources":["D:/Web/OrthoDoc/web/node_modules/xml2js/lib/xml2js.js"],"names":["events","isEmpty","sax","__hasProp","hasOwnProperty","__extends","child","parent","key","call","ctor","constructor","prototype","__super__","__bind","fn","me","apply","arguments","require","thing","Object","keys","length","exports","defaults","explicitCharkey","trim","normalize","attrkey","charkey","explicitArray","ignoreAttrs","mergeAttrs","explicitRoot","validator","ValidationError","_super","message","Error","Parser","opts","parseString","reset","value","_ref","options","err","stack","_this","removeAllListeners","saxParser","parser","onerror","error","emit","EXPLICIT_CHARKEY","resultObject","onopentag","node","obj","attributes","name","push","onclosetag","nodeName","old","s","xpath","pop","match","replace","emptyTag","_i","_len","_results","concat","join","Array","ontext","oncdata","text","str","cb","on","result","toString","write","ex","EventEmitter"],"mappings":"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","sourcesContent":["// Generated by CoffeeScript 1.3.3\n(function() {\n  var events, isEmpty, sax,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n  sax = require('sax');\n\n  events = require('events');\n\n  isEmpty = function(thing) {\n    return typeof thing === \"object\" && (thing != null) && Object.keys(thing).length === 0;\n  };\n\n  exports.defaults = {\n    \"0.1\": {\n      explicitCharkey: false,\n      trim: true,\n      normalize: true,\n      attrkey: \"@\",\n      charkey: \"#\",\n      explicitArray: false,\n      ignoreAttrs: false,\n      mergeAttrs: false,\n      explicitRoot: false,\n      validator: null\n    },\n    \"0.2\": {\n      explicitCharkey: false,\n      trim: false,\n      normalize: false,\n      attrkey: \"$\",\n      charkey: \"_\",\n      explicitArray: true,\n      ignoreAttrs: false,\n      mergeAttrs: false,\n      explicitRoot: true,\n      validator: null\n    }\n  };\n\n  exports.ValidationError = (function(_super) {\n\n    __extends(ValidationError, _super);\n\n    function ValidationError(message) {\n      this.message = message;\n    }\n\n    return ValidationError;\n\n  })(Error);\n\n  exports.Parser = (function(_super) {\n\n    __extends(Parser, _super);\n\n    function Parser(opts) {\n      this.parseString = __bind(this.parseString, this);\n\n      this.reset = __bind(this.reset, this);\n\n      var key, value, _ref;\n      this.options = {};\n      _ref = exports.defaults[\"0.2\"];\n      for (key in _ref) {\n        if (!__hasProp.call(_ref, key)) continue;\n        value = _ref[key];\n        this.options[key] = value;\n      }\n      for (key in opts) {\n        if (!__hasProp.call(opts, key)) continue;\n        value = opts[key];\n        this.options[key] = value;\n      }\n      this.reset();\n    }\n\n    Parser.prototype.reset = function() {\n      var attrkey, charkey, err, stack,\n        _this = this;\n      this.removeAllListeners();\n      this.saxParser = sax.parser(true, {\n        trim: false,\n        normalize: false\n      });\n      err = false;\n      this.saxParser.onerror = function(error) {\n        if (!err) {\n          err = true;\n          return _this.emit(\"error\", error);\n        }\n      };\n      this.EXPLICIT_CHARKEY = this.options.explicitCharkey;\n      this.resultObject = null;\n      stack = [];\n      attrkey = this.options.attrkey;\n      charkey = this.options.charkey;\n      this.saxParser.onopentag = function(node) {\n        var key, obj, _ref;\n        obj = {};\n        obj[charkey] = \"\";\n        if (!_this.options.ignoreAttrs) {\n          _ref = node.attributes;\n          for (key in _ref) {\n            if (!__hasProp.call(_ref, key)) continue;\n            if (!(attrkey in obj) && !_this.options.mergeAttrs) {\n              obj[attrkey] = {};\n            }\n            if (_this.options.mergeAttrs) {\n              obj[key] = node.attributes[key];\n            } else {\n              obj[attrkey][key] = node.attributes[key];\n            }\n          }\n        }\n        obj[\"#name\"] = node.name;\n        return stack.push(obj);\n      };\n      this.saxParser.onclosetag = function() {\n        var node, nodeName, obj, old, s, xpath;\n        obj = stack.pop();\n        nodeName = obj[\"#name\"];\n        delete obj[\"#name\"];\n        s = stack[stack.length - 1];\n        if (obj[charkey].match(/^\\s*$/)) {\n          delete obj[charkey];\n        } else {\n          if (_this.options.trim) {\n            obj[charkey] = obj[charkey].trim();\n          }\n          if (_this.options.normalize) {\n            obj[charkey] = obj[charkey].replace(/\\s{2,}/g, \" \").trim();\n          }\n          if (Object.keys(obj).length === 1 && charkey in obj && !_this.EXPLICIT_CHARKEY) {\n            obj = obj[charkey];\n          }\n        }\n        if (_this.options.emptyTag !== void 0 && isEmpty(obj)) {\n          obj = _this.options.emptyTag;\n        }\n        if (_this.options.validator != null) {\n          xpath = \"/\" + ((function() {\n            var _i, _len, _results;\n            _results = [];\n            for (_i = 0, _len = stack.length; _i < _len; _i++) {\n              node = stack[_i];\n              _results.push(node[\"#name\"]);\n            }\n            return _results;\n          })()).concat(nodeName).join(\"/\");\n          obj = _this.options.validator(xpath, s && s[nodeName], obj);\n        }\n        if (stack.length > 0) {\n          if (!_this.options.explicitArray) {\n            if (!(nodeName in s)) {\n              return s[nodeName] = obj;\n            } else if (s[nodeName] instanceof Array) {\n              return s[nodeName].push(obj);\n            } else {\n              old = s[nodeName];\n              s[nodeName] = [old];\n              return s[nodeName].push(obj);\n            }\n          } else {\n            if (!(s[nodeName] instanceof Array)) {\n              s[nodeName] = [];\n            }\n            return s[nodeName].push(obj);\n          }\n        } else {\n          if (_this.options.explicitRoot) {\n            old = obj;\n            obj = {};\n            obj[nodeName] = old;\n          }\n          _this.resultObject = obj;\n          return _this.emit(\"end\", _this.resultObject);\n        }\n      };\n      return this.saxParser.ontext = this.saxParser.oncdata = function(text) {\n        var s;\n        s = stack[stack.length - 1];\n        if (s) {\n          return s[charkey] += text;\n        }\n      };\n    };\n\n    Parser.prototype.parseString = function(str, cb) {\n      if ((cb != null) && typeof cb === \"function\") {\n        this.on(\"end\", function(result) {\n          this.reset();\n          return cb(null, result);\n        });\n        this.on(\"error\", function(err) {\n          this.reset();\n          return cb(err);\n        });\n      }\n      if (str.toString().trim() === '') {\n        this.emit(\"end\", null);\n        return true;\n      }\n      try {\n        return this.saxParser.write(str.toString());\n      } catch (ex) {\n        if (ex instanceof exports.ValidationError) {\n          return this.emit(\"error\", ex.message);\n        } else {\n          throw ex;\n        }\n      }\n    };\n\n    return Parser;\n\n  })(events.EventEmitter);\n\n}).call(this);\n"]},"metadata":{},"sourceType":"script"}